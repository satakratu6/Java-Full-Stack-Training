SQL> 
SQL> 
SQL> -- Q1) WAQTD DNO AND NUMBER OF EMP WORKING IN EACH DEPT IF THERE ARE AT LEAST 2 CLERKS IN EACH DEPT
SQL> 
SQL> select deptno, count(*) from emp
  2  group by deptno
  3  
SQL> 
SQL> 
SQL> 
SQL> select deptno, count(*) from emp where job in 'CLERK' group by deptno having count(*) >2;

no rows selected

SQL> select deptno, count(*) from emp where job = 'CLERK' group by deptno having count(*) >2;

no rows selected

SQL> SELECT DEPTNO, COUNT(*)
  2  FROM EMP
  3  WHERE JOB='CLERK'
  4  GROUP BY DEPTNO
  5  HAVING COUNT(*) >= 2;

    DEPTNO   COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20          2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> 
SQL> 
SQL> --Q2) WAQTD DNO AND TOTAL SAALARYNEEDED TO PAY ALL EMP IN EACH DEPT IF THERE ARE AT LEAST 4 EMP IN EACH DEPT
SQL> 
SQL> select deptno, sum(sal) from emp group by deptno having count(*)>=4;

    DEPTNO   SUM(SAL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30       9400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20      10875                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> 
SQL> 
SQL> -- Q3) WAQTD NUMBER OF EMP EARNING SAL MORE THAN 1200 IN EACH JOB AND THE TOTAL SAL NEEDED TO PAY EMP OF EACH JOB MUST EXCEED 3800
SQL> 
SQL> select job, count(*), sum(sal) from emp where sal >1200 group by job having sum(sal) >3800;

JOB         COUNT(*)   SUM(SAL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
--------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
SALESMAN           4       5600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
PRESIDENT          1       5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
MANAGER            3       8275                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
ANALYST            2       6000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> 
SQL> 
SQL> -- Q4) WAQTD DEPTNO AND NUMBER OF EMP WORKING ONLY IF THERE ARE 2 EMP WORKING IN EACH DEPT AS MANAGER.
SQL> 
SQL> select deptno, count(*) from emp where job in 'MANAGER' group by deptno having count(*) >2;

no rows selected

SQL> select deptno, count(*) from emp where job in ('MANAGER') group by deptno having count(*) =2;

no rows selected

SQL> select deptno, count(*) from emp where job = 'MANAGER' group by deptno having count(*) =2;

no rows selected

SQL> select deptno, count(*) from emp where job = 'MANAGER' group by deptno having count(*) =1;

    DEPTNO   COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30          1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20          1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        10          1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> 
SQL> --Q5) WAQTD JOB AND MAX SAL OF EMP IN EACH JOB IF THE MAX SAL EXCEEDS 2600
SQL> select job,max(sal) from emp group by job having max(sal) >2000;

JOB         MAX(SAL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
--------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
PRESIDENT       5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MANAGER         2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
ANALYST         3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

SQL> 
SQL> --Q6) WAQTD THE SALARIES WHICH ARE REPEATED IN EMP TABLE
SQL> 
SQL> select sal from emp group by sal having count(*) >2;

no rows selected

SQL> select sal from emp group by sal having count(*) >1;

       SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
      1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
      3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> 
SQL> -- Q7) WAQTD THE HIREDATE WHICH ARE DUPLICATED IN EMP TABLE
SQL> 
SQL> select hiredate from emp group by hiredate having count(*) >1;

HIREDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
---------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
03-DEC-81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

SQL> -- Q8)  WAQTD AVG SALARY OF EACH DEPT IF AVG SAL IS LESS THAN 3000
SQL> 
SQL> select deptno, avg(sal) from emp group by deptno having avg(sal)<3000;

    DEPTNO   AVG(SAL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30 1566.66667                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20       2175                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        10 2916.66667                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> 
SQL> -- Q9) WAQTD DEPTNO IF THERE ARE ATLEAST 3 EMP IN EACH DEPT WHOS NAME HAS CHAR 'A' OR 'S'...
SQL> 
SQL> 
SQL> 
SQL> 
SQL> -- Q9) WAQTD DEPTNO IF THERE ARE ATLEAST 3 EMP IN EACH DEPT WHOS NAME HAS CHAR 'A' OR 'S'...
SQL> 
SQL> select deptno from emp where ename like '%A%' or ename like '%S%' group by deptno having count(*) >3;

    DEPTNO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> select deptno from emp where ename like '%A%' or ename like '%S%' group by deptno having count(*) >=3;

    DEPTNO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        30                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> 
SQL> -- Q10) WAQTD MIN AND MAX SALARIES OF EACH JOB IF MIN SAL IS MORE THAN 1000 AND MAX SAL IS LESS THAN 5000.
SQL> 
SQL> select job, MAX(SAL), MIN(SAL) from emp group by JOB HAVING MAX(SAL) > 1000 MIN(SAL)<5000;
select job, MAX(SAL), MIN(SAL) from emp group by JOB HAVING MAX(SAL) > 1000 MIN(SAL)<5000
                                                                            *
ERROR at line 1:
ORA-00933: SQL command not properly ended 


SQL> select job, MAX(SAL), MIN(SAL) from emp group by JOB HAVING MAX(SAL) > 1000, MIN(SAL)<5000;
select job, MAX(SAL), MIN(SAL) from emp group by JOB HAVING MAX(SAL) > 1000, MIN(SAL)<5000
                                                                           *
ERROR at line 1:
ORA-00933: SQL command not properly ended 


SQL> select job, MAX(SAL), MIN(SAL) from emp group by JOB HAVING MAX(SAL) > 1000 AND MIN(SAL)<5000;

JOB         MAX(SAL)   MIN(SAL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
--------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
CLERK           1300        800                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
SALESMAN        1600       1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
MANAGER         2975       2450                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
ANALYST         3000       3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> spool off;
